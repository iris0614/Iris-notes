<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SQL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/favicon_io/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./sql.html" rel="" target="" aria-current="page">
 <span class="menu-text">SQL</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#relational-databases" id="toc-relational-databases" class="nav-link active" data-scroll-target="#relational-databases">Relational Databases</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#using-a-dbms-ensures" id="toc-using-a-dbms-ensures" class="nav-link" data-scroll-target="#using-a-dbms-ensures">Using a DBMS ensures:</a></li>
  </ul></li>
  <li><a href="#relational-data-model" id="toc-relational-data-model" class="nav-link" data-scroll-target="#relational-data-model">Relational Data Model</a></li>
  <li><a href="#relational-database-a-collection-of-relations." id="toc-relational-database-a-collection-of-relations." class="nav-link" data-scroll-target="#relational-database-a-collection-of-relations.">Relational Database: A collection of relations.</a></li>
  <li><a href="#query-language-in-a-dbms" id="toc-query-language-in-a-dbms" class="nav-link" data-scroll-target="#query-language-in-a-dbms">Query language in a DBMS</a></li>
  <li><a href="#postgresql" id="toc-postgresql" class="nav-link" data-scroll-target="#postgresql">PostgreSQL</a>
  <ul class="collapse">
  <li><a href="#psql-postgresqls-interactive-command-line-interface" id="toc-psql-postgresqls-interactive-command-line-interface" class="nav-link" data-scroll-target="#psql-postgresqls-interactive-command-line-interface">psql: PostgreSQLâ€™s interactive command-line interface</a></li>
  </ul></li>
  <li><a href="#sql-commands" id="toc-sql-commands" class="nav-link" data-scroll-target="#sql-commands">SQL commands:</a>
  <ul class="collapse">
  <li><a href="#the-order-of-sql-clauses" id="toc-the-order-of-sql-clauses" class="nav-link" data-scroll-target="#the-order-of-sql-clauses">The order of SQl clauses:</a></li>
  <li><a href="#data-types" id="toc-data-types" class="nav-link" data-scroll-target="#data-types">Data types:</a></li>
  <li><a href="#nulls" id="toc-nulls" class="nav-link" data-scroll-target="#nulls"><strong>Nulls</strong></a></li>
  <li><a href="#where" id="toc-where" class="nav-link" data-scroll-target="#where"><strong>WHERE</strong></a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SQL</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="relational-databases" class="level1">
<h1>Relational Databases</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<ul>
<li>What is a database?
<ul>
<li>Organized collection of related data</li>
</ul></li>
<li>What is a database management system (DBMS)?
<ul>
<li>Collection of programs that enables users to create and maintain a database</li>
<li>allows users to create, query, modify, and manage</li>
</ul></li>
</ul>
<p><strong>DATABASE != DBMS</strong></p>
<section id="using-a-dbms-ensures" class="level3">
<h3 class="anchored" data-anchor-id="using-a-dbms-ensures">Using a DBMS ensures:</h3>
<ul>
<li><strong>Efficiency</strong>: Data is stored efficiently.</li>
<li><strong>Integrity</strong>: Data is consistent and correct.</li>
<li><strong>Security</strong>: Data is safe from unauthorized access.</li>
<li><strong>Concurrent Access</strong>: Multiple users can access the same data at the same time.</li>
<li><strong>Crash Recovery</strong>: Data is safe from crashes.</li>
<li><strong>Independence</strong>: Data is independent of the programs that use it.</li>
</ul>
</section>
</section>
<section id="relational-data-model" class="level2">
<h2 class="anchored" data-anchor-id="relational-data-model">Relational Data Model</h2>
<ul>
<li>Works with entities and relationships</li>
<li><strong>Entity</strong>: a thing or object in the real world that is distinguishable from other objects
<ul>
<li>e.g.&nbsp;students in a school</li>
</ul></li>
<li><strong>Relationship</strong>: an association among entities
<ul>
<li>e.g.&nbsp;a student is enrolled in a course</li>
</ul></li>
</ul>
</section>
<section id="relational-database-a-collection-of-relations." class="level2">
<h2 class="anchored" data-anchor-id="relational-database-a-collection-of-relations.">Relational Database: A collection of relations.</h2>
<ul>
<li>A <strong>relation</strong> is an instance of a relation schema (just like an object was an instance of a class!)</li>
<li><strong>Relation Schema</strong> specifies:
<ol type="1">
<li>Name of a relation</li>
<li>Name and domain of each attribute</li>
</ol></li>
<li><strong>Domain</strong>: A set of constraints that determines the type, length, format, range, uniqueness and nullability of values stored for an attribute.</li>
</ul>
<p><img src="img/1_Anatomy_of_a_table.png" width="400"></p>
</section>
<section id="query-language-in-a-dbms" class="level2">
<h2 class="anchored" data-anchor-id="query-language-in-a-dbms">Query language in a DBMS</h2>
<ul>
<li>Query: A question that we ask about the data. The result of a query is a new relation.</li>
<li><strong>Structured Query Language (SQL)</strong>: A programming language taht we use to talk to a relational DBMS. <strong>SQL != relational model != database != DBMS</strong> SQL is a standard language for storing, manipulating and retrieving data in databases.</li>
<li>The data query language(DQL) is part of a bigger set of languages for working with data in a realational database, which consists of:
<ul>
<li><strong>Data Definition Language (DDL)</strong> for creating, altering and deleting tables.</li>
<li><strong>Data Manipulation Language (DML)</strong> for inserting new data, updating values, etc.</li>
<li><strong>Data Query Language (DQL)</strong> for quering and retrieving data.</li>
<li><strong>Data Control Language (DCL)</strong> for management and controlling user access, rights and privileges.</li>
</ul></li>
</ul>
</section>
<section id="postgresql" class="level2">
<h2 class="anchored" data-anchor-id="postgresql">PostgreSQL</h2>
<ul>
<li>It is an open-source, cross-platform DBMS that implements the relational model.</li>
</ul>
<section id="psql-postgresqls-interactive-command-line-interface" class="level3">
<h3 class="anchored" data-anchor-id="psql-postgresqls-interactive-command-line-interface">psql: PostgreSQLâ€™s interactive command-line interface</h3>
<table class="table">
<thead>
<tr class="header">
<th>Command</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>\l</code></td>
<td>List all databases</td>
</tr>
<tr class="even">
<td><code>\c</code></td>
<td>Connect to a database</td>
</tr>
<tr class="odd">
<td><code>\d</code></td>
<td>Describe tables and views</td>
</tr>
<tr class="even">
<td><code>\dt</code></td>
<td>List tables</td>
</tr>
<tr class="odd">
<td><code>\dt+</code></td>
<td>List tables with additional info</td>
</tr>
<tr class="even">
<td><code>\d+</code></td>
<td>List tables and views with additional info</td>
</tr>
<tr class="odd">
<td><code>\!</code></td>
<td>Execute shell commands</td>
</tr>
<tr class="even">
<td><code>\cd</code></td>
<td>Change directory</td>
</tr>
<tr class="odd">
<td><code>\i</code></td>
<td>Execute commands from a file</td>
</tr>
<tr class="even">
<td><code>\h</code></td>
<td>View help on SQL commands</td>
</tr>
<tr class="odd">
<td><code>\?</code></td>
<td>View help on psql meta commands</td>
</tr>
<tr class="even">
<td><code>\q</code></td>
<td>Quit interactive shell</td>
</tr>
</tbody>
</table>
<p>Note that you donâ€™t need to terminate meta commands with <code>;</code>.</p>
</section>
</section>
<section id="sql-commands" class="level2">
<h2 class="anchored" data-anchor-id="sql-commands">SQL commands:</h2>
<section id="the-order-of-sql-clauses" class="level3">
<h3 class="anchored" data-anchor-id="the-order-of-sql-clauses">The order of SQl clauses:</h3>
<ul>
<li>SELECT</li>
<li>FROM</li>
<li>WHERE</li>
<li>ORDER BY</li>
<li>LIMIT</li>
</ul>
</section>
<section id="data-types" class="level3">
<h3 class="anchored" data-anchor-id="data-types">Data types:</h3>
<ul>
<li><p>How we convert values from one type to another. In standard SQL, type conversion can be done using the <code>CAST</code> function: <code>CAST(&lt;column&gt; AS &lt;data_type&gt;)</code>. In Postgres, we can also use the double-colon syntax as a shorthand for the above <code>CAST</code> function: <code>&lt;column&gt;::&lt;data_type&gt;</code>.</p></li>
<li><p><strong>Boolean</strong>, <code>BOOLEAN</code> or <code>BOOL</code></p>
<ul>
<li>True: <code>TRUE</code>, <code>t</code>, <code>true</code>, <code>y</code>, <code>yes</code>, <code>YES</code>, <code>Y</code>, <code>T</code>, <code>1(or any other positive integer)</code></li>
<li>False: <code>FALSE</code>, <code>0</code>, <code>NO</code>, <code>N</code>, <code>F</code></li>
</ul></li>
<li><p><strong>Characters</strong></p>
<ul>
<li><code>CHAR(n)</code>: a string of exactly <code>n</code> characters padded with spaces.</li>
<li><code>VARCHAR(n)</code>: a variable set of <code>n</code> characters.</li>
<li><code>TEXT</code>: Postgres specific type for which there is practically no limit on the number of characters.</li>
</ul></li>
<li><p><strong>DateTime</strong>: date and time</p>
<ul>
<li><code>DATE</code>: date (YYYY-MM-DD)
<ul>
<li><code>CURRENT_DATE</code>: current date</li>
</ul></li>
<li><code>TIME</code>: time</li>
<li><code>TIMESTAMP</code>: date and time</li>
<li><code>TIMESTAMPTZ</code>: date and time with timezone</li>
</ul></li>
<li><p><strong>Binary</strong>: binary data</p></li>
<li><p><strong>Numbers</strong>:</p></li>
<li><p>Integers</p></li>
</ul>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 28%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Storage Size</th>
<th>Description</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>smallint</code></td>
<td>2 bytes</td>
<td>small-range integer</td>
<td>-32,768 to +32,767</td>
</tr>
<tr class="even">
<td><code>integer</code></td>
<td>4 bytes</td>
<td>typical choice for integer</td>
<td>-2,147,483,648 to +2,147,483,647</td>
</tr>
<tr class="odd">
<td><code>bigint</code></td>
<td>8 bytes</td>
<td>large-range integer</td>
<td>-9,223,372,036,854,775,808 to +9,223,372,036,854,775,807</td>
</tr>
<tr class="even">
<td><code>serial</code></td>
<td>4 bytes</td>
<td>auto-incrementing integer</td>
<td>1 to 2,147,483,647</td>
</tr>
<tr class="odd">
<td><code>bigserial</code></td>
<td>8 bytes</td>
<td>large auto-incrementing integer</td>
<td>1 to 9,223,372,036,854,775,807</td>
</tr>
</tbody>
</table>
<ul>
<li>Floating-point numbers</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 24%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Storage Size</th>
<th>Description</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>real</code></td>
<td>4 bytes</td>
<td>variable-precision, inexact</td>
<td>at least 6 decimal digits (implementation dependent)</td>
</tr>
<tr class="even">
<td><code>double precision</code></td>
<td>8 bytes</td>
<td>variable-precision, inexact</td>
<td>at least 15 decimal digits (implementation dependent)</td>
</tr>
</tbody>
</table>
<ul>
<li>Arbitrary precision numbers</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 24%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Storage Size</th>
<th>Description</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>numeric</code> or <code>decimal</code></td>
<td>variable</td>
<td>user-specified precision, exact</td>
<td>131072 digits before and 16383 digits after the decimal point</td>
</tr>
</tbody>
</table>
<p><em>Note:With the numeric data type, we can specify the total number of significant digits to store (known as precision) as well as the number of digits in the fractional part (known as scale) by specifying NUMERIC(precision, scale):SELECT CAST(â€˜183.123456789â€™ AS NUMERIC(5, 2)); 183.12</em></p>
<ul>
<li><strong>Date/time</strong>:
<ul>
<li><code>DATE</code>: dates (YYYY-MM-DD)</li>
<li><code>TIME</code>: the time of day</li>
<li><code>TIMESTAMP</code>: date + time</li>
<li><code>TIMESTAMPTZ</code>: date + time + timezone</li>
<li><code>Intervals</code>: storing intervals of time <code>'3 years 2 months 23 hours 8 minutes 18s'::INTERVAL</code> 1155 days, 23:08:18</li>
</ul></li>
</ul>
</section>
<section id="nulls" class="level3">
<h3 class="anchored" data-anchor-id="nulls"><strong>Nulls</strong></h3>
<p>A null is marker to indicate that the value for a column is unknown, or not entered yet.A null is not equal to 0, or an empty string. In fact, a null is not even equal to another null!</p>
<p>How different environments show nulls:</p>
<ul>
<li>ipython-sql -&gt; None</li>
<li>psql -&gt; blank space</li>
<li>pgAdmin -&gt; [null]</li>
</ul>
</section>
<section id="where" class="level3">
<h3 class="anchored" data-anchor-id="where"><strong>WHERE</strong></h3>
<table class="table">
<colgroup>
<col style="width: 42%">
<col style="width: 57%">
</colgroup>
<thead>
<tr class="header">
<th>Condition Example</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>WHERE column = value</code></td>
<td>Equals; returns true if the column equals the value.</td>
</tr>
<tr class="even">
<td><code>WHERE column &lt;&gt; value</code></td>
<td>Not equals; true if the column is not equal to value.</td>
</tr>
<tr class="odd">
<td><code>WHERE column &gt; value</code></td>
<td>Greater than; true if the column is more than value.</td>
</tr>
<tr class="even">
<td><code>WHERE column &lt; value</code></td>
<td>Less than; true if the column is less than value.</td>
</tr>
<tr class="odd">
<td><code>WHERE column BETWEEN value1 AND value2</code></td>
<td>True if the column is within the range of value1 and value2.</td>
</tr>
<tr class="even">
<td><code>WHERE column [NOT] IN (value1, value2, ...)</code></td>
<td>True if the column is [NOT] equal to any of multiple values.</td>
</tr>
<tr class="odd">
<td><code>WHERE column [NOT] LIKE pattern</code></td>
<td>True if the column [NOT] matches the SQL pattern.</td>
</tr>
<tr class="even">
<td><code>WHERE column IS [NOT] NULL</code></td>
<td>True if the column is [NOT] NULL.</td>
</tr>
</tbody>
</table>
<p><em>Note that in SQL, strings are enclosed in single quotes, i.e.&nbsp;â€˜stringâ€™.</em></p>
<p><em>While SQL syntax is case-insensitive, string comparisons in SQL can be case-sensitive depending on the database system and collation settings. For example, in some systems, â€˜Lost highwayâ€™ will not return any rows if the actual data is â€˜Lost Highwayâ€™.</em></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>